
<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title> Autómatas finitos de JavaScript </title>
</head>
<script>
    STATIC = {
        "and":"1","array":"2","begin":"3","bool":"4",
        "call":"5","case":"6","char":"7","constant":"8",
        "dim":"9","do":"10","else":"11","end":"12",
        "false":"13","for":"14","if":"15","input":"16",
        "integer":"17","not":"18","of":"19","or":"20","output":"21",
        "procedure":"22","program":"23","read":"24","real":"25","repeat":"26",
        "set":"27","stop":"28","then":"29","to":"30","true":"31","until":"32",
        "var":"33","while":"34","write":"35","(":"39",")":"40","*":"41","+":"43",
        ",":"44","-":"45",".":"46","..":"47","/":"48",":":"50",":=":"51",";":"52",
        "<":"53","<=":"54","<>":"55","=":"56",">":"57",">=":"58","[":"59","]":"60"
    };
 
 
    _MEMORAY = [];
    _SYMBLE = [];
    _state = 0;
    MEMORAY = [];
 
    var State = function () {
        var state = {
            state0: function () {
                if (_MEMORAY.length > 0) {
                    var string = '';
                    _MEMORAY.forEach(function (item) {
                        string = string + item
                    });
                    MEMORAY.push(string);
                }
                if (_SYMBLE.length > 0) {
                    var symble = '';
                    _SYMBLE.forEach(function (item) {
                        symble = symble + item
                    });
                    MEMORAY.push(symble);
                }
                _state = 0;
                _SYMBLE = [];
                _MEMORAY = [];
            },
            state1: function (value) {
                if (_state === 0 || _state === 1) {
                    _state = 1;
                    _MEMORAY.push(value)
                } else {
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state3: function (value) {
                if (_state === 0) {
                    _state = 3;
                    MEMORAY.push(value)
                } else {
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state5: function (value) {
                if(_state === 0){
                    _state = 5;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state6: function () {
            },
            state7: function (value) {
                if(_state === 0){
                    _state = 7;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state8: function (value) {
                if(_state === 0){
                    _state = 8;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state9: function (value) {
                if(_state === 0){
                    _state = 9;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state10: function (value) {
                if(_state === 0){
                    _state = 10;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state11: function (value) {
                if(_state === 0){
                    _state = 11;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state14: function () {
                if(_state === 5){
                    _state = 14;
                    _SYMBLE =[]
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state15: function (value) {
                if(_state === 7){
                    _state = 15;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state16: function (value) {
                if(_state === 7){
                    _state = 16;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state17: function (value) {
                if(_state === 8){
                    _state = 17;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state18: function (value) {
                if(_state === 9){
                    _state = 18;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state19: function (value) {
                if(_state === 11){
                    _state = 19;
                    _SYMBLE.push(value)
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state20: function () {
                if(_state === 14){
                    _state = 20;
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state21: function () {
                if(_state === 20){
                    _state = 21;
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state22: function () {
                if(_state === 10){
                    _state = 22;
                }else{
                                         console.log ('error');
                                         devolver nuevo Error ('error')
                }
            },
            state500: function () {
                                 console.log ('error');
                                 devolver nuevo Error ('error')
            },
        };
 
        function showState(value) {
            var num = 0;
            if(_state === 3||_state === 4||_state === 6 || _state === 19
                    ||_state === 22 ||_state === 18 || _state === 17
                    ||_state === 16||_state === 15||_state === 21){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 10 && value.charCodeAt(0) !== 46){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 9 && value.charCodeAt(0) !== 61){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 8 && value.charCodeAt(0) !== 61){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 7 && value.charCodeAt(0) !== 61){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 7 && value.charCodeAt(0) !== 62){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if(_state === 5 && value.charCodeAt(0) !== 42){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if (_state === 14 && value.charCodeAt(0) !== 42) {return ''}
            if (_state === 20 && value.charCodeAt(0) !== 47) {
                _state = 14;
                return ''
            }
            if(_state === 1 && (new RegExp(/^[a-zA-Z]+$/)).test(value)=== false&&(new RegExp("^[0-9]*$")).test(value)=== false){
                _state = 0;
                num = 0;
                state['state' + num] && state['state' + num](value);
                return showState(value)
            }
            if (_state === 11 && value.charCodeAt(0) !== 39) {
                _SYMBLE.push(value);
                return ''
            }
                         // Inicialización de retorno de carro y espacio
            if ((new RegExp(/\s+/g)).test(value) || (new RegExp(/[\r\n]/g)).test(value)) {
                    num = 0;
 
            }
                         // Letras, números, saltar al 1
            else if ((new RegExp(/^[a-zA-Z]+$/)).test(value) ||(new RegExp("^[0-9]*$")).test(value)) {
                    num = 1;
            }
                         // Algunos delimitadores simples comunes, salte a 3
            else if (
                    value.charCodeAt(0) === 43 ||
                    value.charCodeAt(0) === 45 ||
                    value.charCodeAt(0) === 40 ||
                    value.charCodeAt(0) === 41 ||
                    value.charCodeAt(0) === 91 ||
                    value.charCodeAt(0) === 93 ||
                    value.charCodeAt(0) === 59 ||
                    value.charCodeAt(0) === 44) {num = 3;}
                         // * símbolo, si es 0, omita 3, si es 5, omita 14
            else if (
                    value.charCodeAt(0) === 42) {
                if(_state === 0){
                    num = 3;
                }else if(_state === 5){
                    num = 14;
                }else if(_state === 14){
                    num = 20
                }
            }
                         // / símbolo, si es 0, salta a 5, si es 20, salta a 21
            else if (
                    value.charCodeAt(0) === 47) {
                if(_state === 0){
                    num = 5;
                }else if(_state === 20){
                    num = 21;
                }
            }
                         // = signo, si es 0, omita 3, si es 7, omita 15, si es 8, omita 17, si es 9, omita 18
            else if (
                    value.charCodeAt(0) === 61) {
                if(_state === 0){
                    num = 3;
                }else if(_state === 7){
                    num = 15;
                }else if(_state === 8){
                    num = 17;
                }else if(_state === 9){
                    num = 18;
                }
            }
                         // <signo, si es 0, salta a 7
            else if (value.charCodeAt(0) === 60) {num = 7;}
                         //> símbolo, si es 0, omita 8, si es 7, omita 16
            else if (value.charCodeAt(0) === 62) {
                if(_state === 0){
                    num = 8;
                }else if(_state === 7){
                    num = 16;
                }
 
            }
                         //: símbolo, si es 0, saltar 9
            else if (value.charCodeAt(0) === 58) {num = 9;}
                         //. Símbolo, si es 0, omita 10, si es 10, omita 22
            else if (value.charCodeAt(0) === 46) {
                if(_state === 0){
                    num = 10;
                }else if(_state === 10){
                    num = 22;
                }
            }
                         // 'símbolo, si es 0, omita 11, si es 11, omita 19
            else if (value.charCodeAt(0) === 39) {
                if(_state === 0){
                    num = 11;
                }else if(_state === 11){
                    num = 19;
                }
            }else{
                num = 500
            }
            state['state' + num] && state['state' + num](value)
        }
 
        return {
            show: showState
        }
    }();
 
 
    function clickMe() {
        var number = 1;
        var a = document.getElementById('test').value + ' ';
        for (var i = 0; i < a.length; i++) {
//            var state = new State(a.charAt(i));
            State.show(a.charAt(i));
        }
        var json = {};
        console.log ('El estado final es' + _ estado);
        console.log(MEMORAY);
        MEMORAY.forEach(
                function (item,index) {
                   if(STATIC[item]){
                                               console.log ('número de serie' + índice + '(' + ESTÁTICO [elemento] + ', -)')
                   }else if(isNaN(Number(item)) === false){
                       if(!json[item]){
                           json[item] = number++;
                       }
                                               console.log ('número de serie' + índice + '(37,' + json [elemento] + ')')
                   }else if(!item.indexOf('\'')){
                       if(!json[item]){
                           json[item] = number++;
                       }
                                               console.log ('número de serie' + índice + '(38,' + json [elemento] + ')')
                   }else{
                       if(!json[item]){
                           json[item] = number++;
                       }
                                               console.log ('número de serie' + índice + '(36,' + json [elemento] + ')')
                   }
                }
        );
    }
</script>
<body>
<div id="container">
    <label>
        <textarea rows="30" cols="50" id="test"></textarea>
                 <button onclick = "clickMe ()"> Recuerde actualizar cada vez </button>
    </label>
</div>
</body>


